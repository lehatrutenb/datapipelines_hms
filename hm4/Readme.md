# Постановка

Задача1: научиться точно/не точно считать среднее в скользящем окне фикс размера
Задача2: научиться точно/не точно считать среднее в не скользящем окне фикс размера

Где может быть полезна: различная аггригация метрик состояния сервисов

# Сравнительный анализ производительности скользящего среднего (window=7)

## Результаты тестирования при 5 запросах на получение среднего с сортировкой данных внутри запросов и RDD написанным без старания

| Размер данных | Pandas-on-Spark | Spark SQL | RDD (простая) | Ускорение RDD vs Pandas | Ускорение RDD vs Spark SQL |
|--------------|-----------------|-----------|---------------|------------------------|---------------------------|
| **10,000** | 0.321 с | 0.145 с | 4.363 с | 0.07x | 0.03x |
| **50,000** | 0.340 с | 0.113 с | 4.250 с | 0.08x | 0.03x |
| **100,000** | 0.459 с | 0.085 с | 4.253 с | 0.11x | 0.02x |
| **500,000** | 1.550 с | 0.263 с | 4.219 с | 0.37x | 0.06x |
| **10,000,000** | 25.002 с | 0.974 с | 7.150 с | **3.50x** | 0.14x |
| **20,000,000** | 48.499 с | 2.248 с | 12.700 с | **3.82x** | 0.18x |

![alt text](<Screenshot from 2026-02-18 01-03-10.png>)

## Результаты тестирования при 5 запросах на получение среднего с сортировкой данных внутри запросов и RDD написанным со старанием

| Размер данных | Pandas-on-Spark | Spark SQL | RDD (простая) | Ускорение RDD vs Pandas | Ускорение RDD vs Spark SQL |
|--------------|-----------------|-----------|---------------|------------------------|---------------------------|
| **10,000** | 0.558 с | 0.111 с | 3.910 с | 0.14x | 0.03x |
| **50,000** | 0.256 с | 0.101 с | 4.442 с | 0.06x | 0.02x |
| **100,000** | 0.352 с | 0.081 с | 4.414 с | 0.08x | 0.02x |
| **500,000** | 1.302 с | 0.234 с | 4.270 с | 0.30x | 0.05x |
| **10,000,000** | 24.751 с | 1.035 с | 7.254 с | **3.41x** | 0.14x |
| **20,000,000** | 56.008 с | 2.083 с | 12.834 с | **4.36x** | 0.16x |

![alt text](<Screenshot from 2026-02-18 01-15-45.png>)

## Результаты тестирования при 5 запросах на получение среднего с сортировкой данных вне запросов

| Размер данных | Pandas-on-Spark | Spark SQL | RDD (простая) | Ускорение RDD vs Pandas | Ускорение RDD vs Spark SQL |
|--------------|-----------------|-----------|---------------|------------------------|---------------------------|
| **10,000** | 1.631 с | 0.579 с | 8.941 с | 0.18x | 0.06x |
| **50,000** | 1.889 с | 0.483 с | 8.625 с | 0.22x | 0.06x |
| **100,000** | 3.280 с | 0.343 с | 8.650 с | 0.38x | 0.04x |
| **500,000** | 9.001 с | 1.069 с | 7.804 с | 1.15x | 0.14x |
| **10,000,000** | 136.870 с | 4.879 с | 18.338 с | **7.46x** | 0.27x |
| **20,000,000** | 278.854 с | 9.715 с | 32.740 с | **8.52x** | 0.30x |

![alt text](<Screenshot from 2026-02-20 13-59-18.png>)

## Результаты тестирования при 5 запросах на получение среднего с сортировкой данных вне запросов, с использованием foreach по всем элементам на выходе вместо count

| Размер данных | Pandas-on-Spark | Spark SQL | RDD sliding | RDD grouped | **DataFrame grouped** |
|--------------|-----------------|-----------|-------------|-------------|----------------------|
| **10,000** | 1.490 с | 0.800 с | 25.649 с | 12.169 с | **1.132 с** |
| **50,000** | 2.050 с | 0.878 с | 25.491 с | 16.011 с | **0.757 с** |
| **100,000** | 2.836 с | 1.602 с | 26.167 с | 16.322 с | **0.790 с** |
| **500,000** | 9.242 с | 3.803 с | 22.337 с | 25.509 с | **1.525 с** |
| **10,000,000** | 143.234 с | 73.208 с | 57.696 с | 31.876 с | **9.135 с** |
| **20,000,000** | 313.561 с | 165.713 с | 112.177 с | 45.474 с | **19.452 с** |

![alt text](<Screenshot from 2026-02-20 16-04-42-1.png>)

**grouped считают в не скольящем окне